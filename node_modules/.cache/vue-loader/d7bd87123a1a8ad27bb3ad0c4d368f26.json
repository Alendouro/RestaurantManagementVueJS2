{"remainingRequest":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Dashboard/DashboardManager.vue?vue&type=style&index=1&id=6f46b858&scoped=true&lang=css&","dependencies":[{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Dashboard/DashboardManager.vue","mtime":1546433593311},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.title > small {\n  font-size: 12px;\n}\n",{"version":3,"sources":["DashboardManager.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA","file":"DashboardManager.vue","sourceRoot":"src/pages/Dashboard","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"md-layout\">\n      <div class=\"md-layout-item\">\n        <div class=\"row\">\n          <div class=\"col-md-12\">\n            <!-- DASHBOARD MENU -->\n            <md-card>\n              <md-card-header data-background-color=\"green\">\n                <h4 class=\"title\">Invoices <small>pending</small> & Meals <small>terminated</small></h4>\n              </md-card-header>\n              <md-card-content>\n                <table class=\"table\">\n                  <thead>\n                  <tr>\n                    <th>Table number</th>\n                    <th>Start</th>\n                    <th>Total price</th>\n                    <th></th>\n                  </tr>\n                  </thead>\n                  <tbody>\n                  <tr v-for=\"(meal) in meals.terminated\" :key=\"meal.id\">\n                    <td class=\"pt-4\">{{ meal.table_number }}</td>\n                    <td class=\"pt-4\">{{ moment(meal.start).format('DD/MM/YYYY H:m') }}</td>\n                    <td class=\"pt-4\">{{ meal.total_price_preview }}€</td>\n                    <td>\n                      <md-tooltip md-direction=\"top\">Declare this meal as not paid</md-tooltip>\n                      <md-button class=\"m-0 md-danger md-block\" @click=\"declareNotPaid(meal, 'meal')\"><md-icon >money_off</md-icon></md-button>\n                    </td>\n                  </tr>\n                  <tr v-for=\"(invoice) in invoices.pending\" :key=\"invoice.id\">\n                    <td class=\"pt-4\">{{ invoice.meal.table_number }}</td>\n                    <td class=\"pt-4\">{{ moment(invoice.start).format('DD-MM-YYYY H:m') }}</td>\n                    <td class=\"pt-4\">{{ invoice.total_price }}€</td>\n                    <td>\n                      <md-tooltip md-direction=\"top\">Declare this invoice as not paid</md-tooltip>\n                      <md-button class=\"m-0 md-danger md-block\" @click=\"declareNotPaid(invoice, 'invoice')\"><md-icon >money_off</md-icon></md-button>\n                    </td>\n                  </tr>\n                  </tbody>\n                </table>\n              </md-card-content>\n            </md-card>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\n\nimport MealsAPI from \"../../packages/api/Meals.js\";\nimport InvoiceAPI from \"../../packages/api/Invoice.js\";\nimport toastr from 'toastr';\nimport _ from 'lodash';\nimport URLFormatter from '../../packages/url/URLFormatter.js'\n\n\nexport default {\n  data() {\n    return {\n      invoices: {\n        pending: [],\n      },\n      meals: {\n        terminated: [],\n      },\n    };\n  },\n  methods: {\n    // ------- GET METHODS\n    getMealsTerminated(){\n      MealsAPI.getTerminated().then(r => {\n        this.meals.terminated = r.data;\n      });\n    },\n    getInvoicePending(withMeal){\n      InvoiceAPI.getPending(withMeal).then(r => {\n        this.invoices.pending = r.data;\n      });\n    },\n\n    // ------ PUT METHODS\n    putDeclareMealNotPaid(meal){\n      MealsAPI.putMealNotPaid(meal).then(r => {\n        if(r.status !== 200){\n          toastr.error('There was an error updating the meal', 'ERROR');\n          return;\n        }\n\n        const mealsTerminated = this.meals.terminated.slice();\n\n        _.remove(mealsTerminated, (currentMeal) => {\n          return currentMeal.id === meal.id;\n        });\n\n        this.meals.terminated = mealsTerminated;\n\n        toastr.success('Meal was updated successfully', 'SUCCESS');\n      });\n    },\n    putDeclareInvoiceNotPaid(invoice){\n      InvoiceAPI.putDeclareInvoiceNotPaid(invoice).then(r => {\n        if(r.status !== 200){\n          toastr.error('There was an error updating the invoice', 'ERROR');\n          return;\n        }\n\n        const invoicesPending = this.invoices.pending.slice();\n\n        _.remove(invoicesPending, (currentInvoice) => {\n          return currentInvoice.id === invoice.id;\n        });\n\n        this.invoices.pending = invoicesPending;\n\n        toastr.success('Invoice was updated successfully', 'SUCCESS');\n      });\n    },\n\n    // ------- AUXILIARY METHODS\n    groupedItems(items, columns){\n      return _.chunk(items, columns);\n    },\n\n    imageItem(itemUrl){\n      return URLFormatter.imageItem(itemUrl);\n    },\n\n    declareNotPaid(item, type){\n      if(type === 'meal'){\n        this.putDeclareMealNotPaid(item);\n      }\n\n      if(type === 'invoice'){\n        this.putDeclareInvoiceNotPaid(item);\n      }\n    },\n  },\n\n  created(){\n    this.getMealsTerminated();\n    this.getInvoicePending(true);\n  },\n};\n</script>\n\n<style src=\"vue-multiselect/dist/vue-multiselect.min.css\"></style>\n<style scoped>\n  .title > small {\n    font-size: 12px;\n  }\n</style>\n"]}]}