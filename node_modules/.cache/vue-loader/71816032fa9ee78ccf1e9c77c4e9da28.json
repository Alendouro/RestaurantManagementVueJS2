{"remainingRequest":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Invoice.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Invoice.vue","mtime":1546569441508},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport InvoiceAPI from \"../../packages/api/Invoice.js\";\nimport InvoiceItemsAPI from \"../../packages/api/InvoiceItems.js\";\nimport UsersAPI from \"../../packages/api/Users.js\";\nimport Multiselect from 'vue-multiselect'\nimport Datepicker from 'vuejs-datepicker';\nimport moment from 'moment';\n\nexport default {\n  components: { Multiselect, Datepicker },\n  data() {\n    return {\n      invoices: {\n        pending: [],\n        data: null,\n        filters:{\n          state:{\n            active: ['pending'],\n            options: ['paid', 'not paid', 'pending']\n          },\n          waiter:{\n            active: {\n              id: null,\n              name: null\n            },\n            options: [],\n            isLoading: false\n          },\n          date:{\n            date: null\n          }\n        },\n        selected: {\n          invoice: null,\n          items: null\n        }\n      },\n    }\n  },\n\n  methods: {\n    getInvoices(filters, paginate, meal, waiter, page, date, waiterID){\n      InvoiceAPI.getInvoices(filters, paginate, meal, waiter, page, date, waiterID).then(r => {\n        this.invoices.data = r.data;\n      });\n    },\n    getInvoiceItems(invoice){\n      this.invoices.selected.invoice = invoice;\n\n      // Scroll to the bottom of the page\n      window.scrollTo(0,document.body.scrollHeight);\n\n      InvoiceItemsAPI.getInvoiceItems(invoice.id).then(items => {\n        items.data.forEach(function(item){\n          console.log(item.name);\n        });\n        this.invoices.selected.items = items.data;\n      });\n    },\n    searchUsersInvoices(searchQuery){\n      if(searchQuery.length < 3){\n        return;\n      }\n\n      var options = [];\n      this.invoices.filters.waiter.isLoading = true;\n\n      UsersAPI.getSearchUser(searchQuery).then(r => {\n        this.invoices.filters.waiter.isLoading = false;\n        r.data.forEach(e => {\n          options.push({\n            id: e.id,\n            name: e.name\n          });\n        });\n      });\n\n      this.invoices.filters.waiter.options = options;\n    },\n    dataFilter(date){\n      let dateF = moment(date).format('YYYY-MM-DD');\n      this.meals.filters.date.date = dateF;\n      this.invoices.filters.date.date = dateF;\n      return dateF;\n    },\n    printInvoice(){\n      let mywindow = window.open('', 'PRINT', 'height=400,width=600');\n\n      mywindow.document.write('<html><head><title></title>');\n      mywindow.document.write('<link rel=\"stylesheet\" href=\"http://restaurantmanagement.test/css/PDFPrinting.css\" type=\"text/css\" />');\n      mywindow.document.write('</head><body >');\n      mywindow.document.write('<h4 style=\"text-align: center;\">FATURA RESTAURANTE DAD</h4>');\n      mywindow.document.write(document.getElementById('invoiceItems').innerHTML);\n      mywindow.document.write('</body></html>');\n\n      mywindow.document.close(); // necessary for IE >= 10\n      mywindow.focus(); // necessary for IE >= 10*/\n\n      mywindow.print();\n      mywindow.close();\n    },\n    invoicesPaginate(direction){\n      if(direction === 'last'){\n        this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n          true, true, true, this.invoices.data.current_page - 1, this.invoices.filters.date.date, this.invoices.filters.waiter.active.id);\n      }else{\n        this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n          true, true, true, this.invoices.data.current_page + 1, this.invoices.filters.date.date, this.invoices.filters.waiter.active.id);\n      }\n    },\n\n  },\n  created(){\n    this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n      true,\n      true,\n      true,\n      1,\n      null,\n      null\n    );\n  }\n};\n",{"version":3,"sources":["Invoice.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Invoice.vue","sourceRoot":"src/pages/Manager","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"md-layout\">\n      <div class=\"md-layout-item\">\n        <md-button class=\"md-info md-just-icon align-bottom-right\"\n                   v-show=\"(invoices.selected.invoice !== null ? invoices.selected.invoice.state === 'paid' : false)\"\n                   @click=\"printInvoice\"><md-icon >print</md-icon></md-button>\n        <h4><md-icon >filter_list</md-icon>Filters</h4>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <label for=\"invoice_state\">State</label>\n            <multiselect :multiple=\"true\"\n                         v-model=\"invoices.filters.state.active\"\n                         :options=\"invoices.filters.state.options\"\n                         style=\"z-index: 9999;\" id=\"invoice_state\"></multiselect>\n          </div>\n          <div class=\"col-md-6\">\n            <label for=\"invoice_waiter\">Waiter</label>\n            <multiselect v-model=\"invoices.filters.waiter.active\"\n                         :options=\"invoices.filters.waiter.options\"\n                         @search-change=\"searchUsersInvoices\"\n                         :preserve-search=\"true\"\n                         :loading=\"invoices.filters.waiter.isLoading\"\n                         label=\"name\"\n                         track-by=\"name\"\n                         style=\"z-index: 9999;\" id=\"invoice_waiter\"></multiselect>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <label for=\"invoice_date\">Date</label>\n            <datepicker class=\"form-control\" :format=\"dataFilter\" id=\"invoice_date\"></datepicker>\n          </div>\n        </div>\n        <div class=\"row mb-4\">\n          <div class=\"col-md-12\">\n            <md-button @click=\"getInvoices(invoices.filters.state.active.length === 0 ? invoices.filters.state.options : invoices.filters.state.active, true, true, true, 1, invoices.filters.date.date, invoices.filters.waiter.active.id)\"\n                       class=\"md-round md-block md-success\">FILTER</md-button>\n          </div>\n        </div>\n        <md-card v-if=\"this.invoices.data !== null\">\n          <md-card-header data-background-color=\"green\">\n            <h4 class=\"title\">Invoices</h4>\n            <h5 class=\"title\">Total: {{ invoices.data.total }}</h5>\n          </md-card-header>\n          <md-card-content>\n            <table class=\"table\">\n              <thead>\n              <tr>\n                <th>State</th>\n                <th>NIF</th>\n                <th>Name</th>\n                <th>Date</th>\n                <th>Total</th>\n                <th></th>\n              </tr>\n              </thead>\n              <tbody>\n              <tr v-for=\"invoice in invoices.data.data\" :key=\"invoice.id\">\n                <td class=\"pt-4\">{{ invoice.state }}</td>\n                <td class=\"pt-4\">{{ invoice.nif }}</td>\n                <td class=\"pt-4\">{{ invoice.name }}</td>\n                <td class=\"pt-4\">{{ moment(invoice.date).format('DD/MM/YYYY') }}</td>\n                <td class=\"pt-4\">{{ invoice.total_price }}€</td>\n                <td class=\"p-0\">\n                  <md-tooltip md-direction=\"top\">View invoice details</md-tooltip>\n                  <md-button class=\"md-block\" @click=\"getInvoiceItems(invoice)\"><md-icon>remove_red_eye</md-icon></md-button>\n                </td>\n              </tr>\n              </tbody>\n            </table>\n            <md-button :disabled=\"invoices.data.prev_page_url === null\" @click=\"invoicesPaginate('last')\">LAST</md-button>\n            <md-button :disabled=\"invoices.data.next_page_url === null\" @click=\"invoicesPaginate('next')\">NEXT</md-button>\n          </md-card-content>\n        </md-card>\n        <md-card v-if=\"invoices.selected.invoice !== null\" id=\"invoiceItems\">\n          <md-card-header data-background-color=\"green\" id=\"mealDetails\">\n            <h6 class=\"title\">Total: {{ invoices.selected.invoice.total_price }}€</h6>\n            <h6 class=\"title\">State: {{ invoices.selected.invoice.state }}</h6>\n            <h6 class=\"title\">Date: {{ moment(invoices.selected.invoice.created_at).format(\"DD/MM/YYYY\") }}</h6>\n            <h6 class=\"title\">Waiter: {{ invoices.selected.invoice.meal.waiter.name }}</h6>\n          </md-card-header>\n          <md-card-content>\n            <table class=\"table\">\n              <thead>\n              <tr>\n                <th>#</th>\n                <th>Item</th>\n                <th>Type</th>\n                <th>Quantity</th>\n                <th>Unit price</th>\n                <th>Sub total</th>\n              </tr>\n              </thead>\n              <tbody>\n              <tr v-for=\"(item, index) in invoices.selected.items\" :key=\"item.id\">\n                <td class=\"pt-4\">{{ index + 1 }}</td>\n                <td class=\"pt-4\">{{ item.item.name }}</td>\n                <td class=\"pt-4\">{{ item.item.type }}</td>\n                <td class=\"pt-4\">{{ item.quantity }}</td>\n                <td class=\"pt-4\">{{ item.unit_price }}€</td>\n                <td class=\"pt-4\">{{ item.sub_total_price }}€</td>\n              </tr>\n              </tbody>\n            </table>\n          </md-card-content>\n        </md-card>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport InvoiceAPI from \"../../packages/api/Invoice.js\";\nimport InvoiceItemsAPI from \"../../packages/api/InvoiceItems.js\";\nimport UsersAPI from \"../../packages/api/Users.js\";\nimport Multiselect from 'vue-multiselect'\nimport Datepicker from 'vuejs-datepicker';\nimport moment from 'moment';\n\nexport default {\n  components: { Multiselect, Datepicker },\n  data() {\n    return {\n      invoices: {\n        pending: [],\n        data: null,\n        filters:{\n          state:{\n            active: ['pending'],\n            options: ['paid', 'not paid', 'pending']\n          },\n          waiter:{\n            active: {\n              id: null,\n              name: null\n            },\n            options: [],\n            isLoading: false\n          },\n          date:{\n            date: null\n          }\n        },\n        selected: {\n          invoice: null,\n          items: null\n        }\n      },\n    }\n  },\n\n  methods: {\n    getInvoices(filters, paginate, meal, waiter, page, date, waiterID){\n      InvoiceAPI.getInvoices(filters, paginate, meal, waiter, page, date, waiterID).then(r => {\n        this.invoices.data = r.data;\n      });\n    },\n    getInvoiceItems(invoice){\n      this.invoices.selected.invoice = invoice;\n\n      // Scroll to the bottom of the page\n      window.scrollTo(0,document.body.scrollHeight);\n\n      InvoiceItemsAPI.getInvoiceItems(invoice.id).then(items => {\n        items.data.forEach(function(item){\n          console.log(item.name);\n        });\n        this.invoices.selected.items = items.data;\n      });\n    },\n    searchUsersInvoices(searchQuery){\n      if(searchQuery.length < 3){\n        return;\n      }\n\n      var options = [];\n      this.invoices.filters.waiter.isLoading = true;\n\n      UsersAPI.getSearchUser(searchQuery).then(r => {\n        this.invoices.filters.waiter.isLoading = false;\n        r.data.forEach(e => {\n          options.push({\n            id: e.id,\n            name: e.name\n          });\n        });\n      });\n\n      this.invoices.filters.waiter.options = options;\n    },\n    dataFilter(date){\n      let dateF = moment(date).format('YYYY-MM-DD');\n      this.meals.filters.date.date = dateF;\n      this.invoices.filters.date.date = dateF;\n      return dateF;\n    },\n    printInvoice(){\n      let mywindow = window.open('', 'PRINT', 'height=400,width=600');\n\n      mywindow.document.write('<html><head><title></title>');\n      mywindow.document.write('<link rel=\"stylesheet\" href=\"http://restaurantmanagement.test/css/PDFPrinting.css\" type=\"text/css\" />');\n      mywindow.document.write('</head><body >');\n      mywindow.document.write('<h4 style=\"text-align: center;\">FATURA RESTAURANTE DAD</h4>');\n      mywindow.document.write(document.getElementById('invoiceItems').innerHTML);\n      mywindow.document.write('</body></html>');\n\n      mywindow.document.close(); // necessary for IE >= 10\n      mywindow.focus(); // necessary for IE >= 10*/\n\n      mywindow.print();\n      mywindow.close();\n    },\n    invoicesPaginate(direction){\n      if(direction === 'last'){\n        this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n          true, true, true, this.invoices.data.current_page - 1, this.invoices.filters.date.date, this.invoices.filters.waiter.active.id);\n      }else{\n        this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n          true, true, true, this.invoices.data.current_page + 1, this.invoices.filters.date.date, this.invoices.filters.waiter.active.id);\n      }\n    },\n\n  },\n  created(){\n    this.getInvoices(this.invoices.filters.state.active.length === 0 ? this.invoices.filters.state.options : this.invoices.filters.state.active,\n      true,\n      true,\n      true,\n      1,\n      null,\n      null\n    );\n  }\n};\n</script>\n\n<style scoped>\n  .align-bottom-right{\n    bottom: 20px;\n    right: 20px;\n    position: fixed !important;\n    z-index: 999;\n  }\n</style>\n"]}]}