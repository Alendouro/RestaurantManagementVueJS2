{"remainingRequest":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Stats.vue?vue&type=style&index=0&id=76571129&scoped=true&lang=css&","dependencies":[{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Stats.vue","mtime":1546623817076},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.bottom-column{\n  position: absolute;\n  bottom: 0px;\n}\n\n.text-small{\n  font-size: 10px !important;\n}\n",{"version":3,"sources":["Stats.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoWA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Stats.vue","sourceRoot":"src/pages/Manager","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"md-layout\">\n      <div class=\"md-layout-item\">\n        <div class=\"row\">\n          <div class=\"col-md-4\">\n            <stats-card data-background-color=\"green\">\n              <template slot=\"header\">\n                <md-tooltip md-direction=\"top\">Defines the average time a costumer spent in his meal</md-tooltip>\n                <md-icon>whatshot</md-icon>\n              </template>\n\n              <template slot=\"content\">\n                <p class=\"category\">Average time on meal</p>\n                <h3 class=\"title\">{{ topCardsData.averageTimeCostumerSpentMeal }} <small class=\"text-small\">minutes</small></h3>\n              </template>\n            </stats-card>\n          </div>\n          <div class=\"col-md-4\">\n            <stats-card data-background-color=\"green\">\n              <template slot=\"header\">\n                <md-tooltip md-direction=\"top\">Total number of delivered orders made in this restaurant</md-tooltip>\n                <md-icon>poll</md-icon>\n              </template>\n\n              <template slot=\"content\">\n                <p class=\"category\">Delivered orders</p>\n                <h3 class=\"title\">{{ topCardsData.totalNumberOrders }} <small class=\"text-small\">orders</small></h3>\n              </template>\n            </stats-card>\n          </div>\n          <div class=\"col-md-4\">\n            <stats-card data-background-color=\"green\">\n              <template slot=\"header\">\n                <md-tooltip md-direction=\"top\">Total number of meals</md-tooltip>\n                <md-icon>fastfood</md-icon>\n              </template>\n\n              <template slot=\"content\">\n                <p class=\"category\">Average orders per meal</p>\n                <h3 class=\"title\">{{ topCardsData.totalNumberMeals }} <small class=\"text-small\">meals</small></h3>\n              </template>\n            </stats-card>\n          </div>\n        </div>\n        <div class=\"row mb-2\">\n          <div class=\"col-md-10\">\n            <label for=\"stats_user\">User <small>search average performance of user</small></label>\n            <multiselect v-model=\"users.filters.user.active\"\n                         :options=\"users.filters.user.options\"\n                         @search-change=\"searchUsers\"\n                         :preserve-search=\"true\"\n                         :loading=\"users.filters.user.isLoading\"\n                         label=\"name\"\n                         track-by=\"name\"\n                         style=\"z-index: 9999;\" id=\"stats_user\"></multiselect>\n          </div>\n          <div class=\"col-md-1\">\n            <md-button class=\"md-success md-block bottom-column m-0 p-0\"\n                       @click=\"getStatsUser\"\n                       :disabled=\"users.filters.user.active.id === null\"><md-icon >show_chart</md-icon></md-button>\n          </div>\n        </div>\n        <div class=\"row\" v-if=\"performanceUser.data.labels.length > 0\">\n          <div class=\"col-md-12\">\n            <chart-card\n                    :chart-data=\"performanceUser.data\"\n                    :chart-options=\"performanceUser.options\"\n                    chart-type=\"Line\"\n                    data-background-color=\"green\">\n              <template slot=\"content\">\n                <h4 class=\"title\">{{ users.filters.user.active.type === \"cook\" ? \"Number of meals prepared\" : \"Number of orders served\"}}</h4>\n                <p class=\"category\">\n                  Average of {{ performanceUser.data.average }} {{ users.filters.user.active.type === \"cook\" ? \"meals prepared\" : \"orders served\" }}\n                </p>\n              </template>\n            </chart-card>\n          </div>\n        </div>\n        <div class=\"row\" v-if=\"performanceOrders.data.labels.length > 0\">\n          <div class=\"col-md-12\">\n            <chart-card\n                    :chart-data=\"performanceOrders.data\"\n                    :chart-options=\"performanceOrders.options\"\n                    chart-type=\"Line\"\n                    data-background-color=\"green\">\n              <template slot=\"content\">\n                <h4 class=\"title\">Total number of Orders</h4>\n              </template>\n            </chart-card>\n          </div>\n        </div>\n        <div class=\"row\" v-if=\"performanceMeals.data.labels.length > 0\">\n          <div class=\"col-md-12\">\n            <chart-card\n                    :chart-data=\"performanceMeals.data\"\n                    :chart-options=\"performanceMeals.options\"\n                    chart-type=\"Line\"\n                    data-background-color=\"green\">\n              <template slot=\"content\">\n                <h4 class=\"title\">Total number of Meals</h4>\n              </template>\n            </chart-card>\n          </div>\n        </div>\n        <div class=\"row\" v-if=\"performanceMealsAverageTime.data.labels.length > 0\">\n          <div class=\"col-md-12\">\n            <chart-card\n                    :chart-data=\"performanceMealsAverageTime.data\"\n                    :chart-options=\"performanceMealsAverageTime.options\"\n                    chart-type=\"Line\"\n                    data-background-color=\"green\">\n              <template slot=\"content\">\n                <h4 class=\"title\">Average time Meal</h4>\n              </template>\n            </chart-card>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-12\">\n            <md-card v-if=\"performanceOrdersAverageMinutesPerMoth.length > 0\">\n              <md-card-header data-background-color=\"green\" id=\"mealDetails\">\n                <h6 class=\"title\">Average time it takes to handle each order grouped by items and month</h6>\n                <h6 class=\"title\"><md-icon>warning</md-icon>Should be using pagination in here but no time</h6>\n              </md-card-header>\n              <md-card-content>\n                <table class=\"table\">\n                  <thead>\n                  <tr>\n                    <th>#</th>\n                    <th>Item</th>\n                    <th>Month</th>\n                    <th>Average</th>\n\n                  </tr>\n                  </thead>\n                  <tbody>\n                  <tr v-for=\"(item, index) in performanceOrdersAverageMinutesPerMoth\" :key=\"item.id\">\n                    <td class=\"pt-4\">{{ index + 1 }}</td>\n                    <td class=\"pt-4\">{{ item.name }}</td>\n                    <td class=\"pt-4\">{{ item.month }}</td>\n                    <td class=\"pt-4\">{{ item.average }}</td>\n                  </tr>\n                  </tbody>\n                </table>\n              </md-card-content>\n            </md-card>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport UsersAPI from \"../../packages/api/Users.js\";\nimport StatsAPI from \"../../packages/api/Stats.js\";\nimport _ from 'lodash';\nimport Multiselect from 'vue-multiselect'\nimport StatsCard from \"../../../src/components/Cards/StatsCard.vue\";\nimport ChartCard from \"../../../src/components/Cards/ChartCard.vue\";\n\nexport default {\n  components: { Multiselect, ChartCard, StatsCard },\n  data() {\n    return {\n      users: {\n        filters: {\n          user:{\n            active: {\n              id: null,\n              name: null,\n              type: null\n            },\n            options: [],\n            isLoading: false\n          }\n        }\n      },\n      performanceUser: {\n        data: {\n          labels: [],\n          series: [],\n          average: 0\n        },\n        options: {\n          low: 0,\n          high: 1,\n          chartPadding: {\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 20\n          }\n        },\n      },\n      performanceOrders:{\n        data: {\n          labels: [],\n          series: [],\n        },\n        options: {\n          low: 0,\n          high: 1,\n          chartPadding: {\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 25\n          }\n        },\n      },\n      performanceMeals:{\n        data: {\n          labels: [],\n          series: [],\n        },\n        options: {\n          low: 0,\n          high: 1,\n          chartPadding: {\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 25\n          }\n        },\n      },\n      performanceMealsAverageTime:{\n        data: {\n          labels: [],\n          series: [],\n        },\n        options: {\n          low: 0,\n          high: 1,\n          chartPadding: {\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 25\n          }\n        },\n      },\n      performanceOrdersAverageMinutesPerMoth: [],\n      topCardsData:{\n        averageTimeCostumerSpentMeal: '...',\n        totalNumberOrders: '...',\n        totalNumberMeals: '...',\n      }\n    }\n  },\n\n  methods: {\n    searchUsers(searchQuery){\n      if(searchQuery.length < 3){\n        return;\n      }\n\n      var options = [];\n      this.users.filters.user.isLoading = true;\n\n      UsersAPI.getSearchUser(searchQuery).then(r => {\n        this.users.filters.user.isLoading = false;\n        r.data.forEach(e => {\n          if(e.type === \"waiter\" || e.type === \"cook\"){\n            options.push({\n              id: e.id,\n              name: e.name + \" - \" + e.type,\n              type: e.type\n            });\n          }\n        });\n      });\n\n      this.users.filters.user.options = options;\n    },\n    getStatsUser(){\n      StatsAPI.getUserPerformance(this.users.filters.user.active).then(r => {\n        // Calculate the average asked in the US 39\n        let average = (_.sum(r.data.series)/r.data.series.length);\n        this.performanceUser.data.average = average.toFixed(2);\n\n        // Need to set padding of the graph since it doesn't do it automatically\n        // which is a shame.\n        this.setLowHighOptionsGraph(this.performanceUser.options, r.data.series);\n\n        this.performanceUser.data.labels = r.data.labels;\n        // Chartist's series needs to be an array inside of an array\n        this.performanceUser.data.series = [r.data.series];\n      });\n    },\n    getMealsHandled(){\n      StatsAPI.getMealsHandled().then(r => {\n        // Need to set padding of the graph since it doesn't do it automatically\n        // which is a shame.\n        this.setLowHighOptionsGraph(this.performanceMeals.options, r.data.series);\n\n        this.performanceMeals.data.labels = r.data.labels;\n        this.performanceMeals.data.series = [r.data.series];\n\n        // Calculate the total number of meals handled\n        this.topCardsData.totalNumberMeals = _.sum(r.data.series);\n      });\n    },\n    getOrdersHandled(){\n      StatsAPI.getOrdersHandled().then(r => {\n        // Need to set padding of the graph since it doesn't do it automatically\n        // which is a shame.\n        this.setLowHighOptionsGraph(this.performanceOrders.options, r.data.series);\n\n        this.performanceOrders.data.labels = r.data.labels;\n        this.performanceOrders.data.series = [r.data.series];\n\n        // Calculate total number of orders handled in this restaurant\n        this.topCardsData.totalNumberOrders = _.sum(r.data.series);\n      });\n    },\n    getAverageTimeMeal(){\n      StatsAPI.getAverageTimeSpentOnMeal().then(r => {\n        // Need to set padding of the graph since it doesn't do it automatically\n        // which is a shame.\n        this.setLowHighOptionsGraph(this.performanceMealsAverageTime.options, r.data.series);\n\n        this.performanceMealsAverageTime.data.labels = r.data.labels;\n        this.performanceMealsAverageTime.data.series = [r.data.series];\n\n        // Calculate the average on all months that a customer has spent in the restaurant\n        let average = (_.sum(r.data.series)/r.data.series.length);\n        this.topCardsData.averageTimeCostumerSpentMeal = average.toFixed(2);\n      });\n    },\n    getAverageMinutesOrdersPerMonth(){\n      StatsAPI.getAverageMinutesOrdersPerMonth().then(r => {\n        console.log(this.performanceOrdersAverageMinutesPerMoth.length);\n        this.performanceOrdersAverageMinutesPerMoth = r.data;\n        console.log(this.performanceOrdersAverageMinutesPerMoth);\n      });\n    },\n    // ---- AUX METHODS\n    setLowHighOptionsGraph(options, series){\n      options.low = 0;\n      options.high = _.max(series) + 80;\n    }\n  },\n  created(){\n    this.getOrdersHandled();\n    this.getMealsHandled();\n    this.getAverageTimeMeal();\n    this.getAverageMinutesOrdersPerMonth();\n  }\n};\n</script>\n\n<style scoped>\n  .bottom-column{\n    position: absolute;\n    bottom: 0px;\n  }\n\n  .text-small{\n    font-size: 10px !important;\n  }\n</style>\n"]}]}