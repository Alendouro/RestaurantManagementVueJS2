{"remainingRequest":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/babel-loader/lib/index.js!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Meal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/pages/Manager/Meal.vue","mtime":1546433593311},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport MealsAPI from \"../../packages/api/Meals.js\";\nimport ItemsAPI from \"../../packages/api/Items.js\";\nimport OrderAPI from \"../../packages/api/Orders.js\";\nimport InvoiceAPI from \"../../packages/api/Invoice.js\";\nimport InvoiceItemsAPI from \"../../packages/api/InvoiceItems.js\";\nimport TablesAPI from \"../../packages/api/Tables.js\";\nimport UsersAPI from \"../../packages/api/Users.js\";\nimport { required, email } from 'vuelidate/lib/validators';\nimport toastr from 'toastr';\nimport _ from 'lodash';\nimport swal from \"sweetalert\";\nimport Multiselect from 'vue-multiselect';\nimport Datepicker from 'vuejs-datepicker';\nimport moment from 'moment';\nexport default {\n  components: {\n    Multiselect: Multiselect,\n    Datepicker: Datepicker\n  },\n  data: function data() {\n    return {\n      meals: {\n        data: [],\n        filters: {\n          state: {\n            // If there are no active option then it will assume all the options\n            active: ['active', 'terminated'],\n            options: ['active', 'terminated', 'paid', 'not paid']\n          },\n          waiter: {\n            active: {\n              id: null,\n              name: null\n            },\n            options: [],\n            isLoading: false\n          },\n          date: {\n            date: null\n          }\n        },\n        terminated: [],\n        selected: {\n          meal: null,\n          items: []\n        }\n      }\n    };\n  },\n  methods: {\n    getMeals: function getMeals(filters, paginate, waiter, pageNumber, userID, date) {\n      var _this = this;\n\n      MealsAPI.getMeals(filters, paginate, waiter, pageNumber, userID, date).then(function (meals) {\n        _this.meals.data = meals.data;\n      });\n    },\n    searchUsersMeals: function searchUsersMeals(searchQuery) {\n      var _this2 = this;\n\n      if (searchQuery.length < 3) {\n        return;\n      }\n\n      var options = [];\n      this.meals.filters.waiter.isLoading = true;\n      UsersAPI.getSearchUser(searchQuery).then(function (r) {\n        _this2.meals.filters.waiter.isLoading = false;\n        r.data.forEach(function (e) {\n          options.push({\n            id: e.id,\n            name: e.name\n          });\n        });\n      });\n      this.meals.filters.waiter.options = options;\n    },\n    dataFilter: function dataFilter(date) {\n      var dateF = moment(date).format('YYYY-MM-DD');\n      this.meals.filters.date.date = dateF;\n      return dateF;\n    },\n    getMealDetails: function getMealDetails(meal) {\n      var _this3 = this;\n\n      this.meals.selected.meal = meal;\n      MealsAPI.getOrders([], meal.id).then(function (orders) {\n        _this3.meals.selected.items = orders.data;\n        location.hash = \"#mealDetails\";\n      });\n    },\n    mealsPaginate: function mealsPaginate(direction) {\n      if (direction === 'last') {\n        this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active, true, true, this.meals.data.current_page - 1, this.meals.filters.waiter.active.id, this.meals.filters.date.date);\n      } else {\n        this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active, true, true, this.meals.data.current_page + 1, this.meals.filters.waiter.active.id, this.meals.filters.date.date);\n      }\n    }\n  },\n  created: function created() {\n    this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active, true, true, null, null, this.meals.filters.date.date);\n  }\n};",{"version":3,"sources":["Meal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"md-layout\">\n      <div class=\"md-layout-item\">\n        <h4><md-icon >filter_list</md-icon>Filters</h4>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <label for=\"user_state\">State</label>\n            <multiselect :multiple=\"true\"\n                         v-model=\"meals.filters.state.active\"\n                         :options=\"meals.filters.state.options\"\n                         style=\"z-index: 9999;\" id=\"user_state\"></multiselect>\n          </div>\n          <div class=\"col-md-6\">\n            <label for=\"filter_waiter\">User</label>\n            <multiselect v-model=\"meals.filters.waiter.active\"\n                         :options=\"meals.filters.waiter.options\"\n                         @search-change=\"searchUsersMeals\"\n                         :preserve-search=\"true\"\n                         :loading=\"meals.filters.waiter.isLoading\"\n                         label=\"name\"\n                         track-by=\"name\"\n                         style=\"z-index: 9999;\" id=\"filter_waiter\"></multiselect>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <label for=\"filter_date\">Date</label>\n            <datepicker class=\"form-control\" :format=\"dataFilter\" id=\"filter_date\"></datepicker>\n          </div>\n        </div>\n        <div class=\"row mb-4\">\n          <div class=\"col-md-12\">\n            <md-button @click=\"getMeals(meals.filters.state.active.length === 0 ? meals.filters.state.options : meals.filters.state.active,\n                                    true,\n                                    true,\n                                    null,\n                                    meals.filters.waiter.active.id,\n                                    meals.filters.date.date)\"\n                       class=\"md-round md-block md-success\">FILTER</md-button>\n          </div>\n        </div>\n        <md-card>\n          <md-card-header data-background-color=\"green\">\n            <h4 class=\"title\">Meals</h4>\n            <h5 class=\"title\">Total: {{ meals.data.total }}</h5>\n          </md-card-header>\n          <md-card-content>\n            <table class=\"table\">\n              <thead>\n              <tr>\n                <th>Table number</th>\n                <th>Waiter</th>\n                <th>Total price</th>\n                <th>State</th>\n                <th>Created at</th>\n                <th></th>\n              </tr>\n              </thead>\n              <tbody>\n              <tr v-for=\"meal in meals.data.data\" :key=\"meal.id\">\n                <td class=\"pt-4\">{{ meal.table_number }}</td>\n                <div v-if=\"meal.waiter.deleted_at !== null\" class=\"bg-danger text-white rounded\">\n                  <td class=\"pt-4\">{{ meal.waiter.name }}</td>\n                  <md-tooltip md-direction=\"top\">This user is soft deleted</md-tooltip>\n                </div>\n                <div v-else>\n                  <td class=\"pt-4\">{{ meal.waiter.name }}</td>\n                </div>\n                <td class=\"pt-4\">{{ meal.total_price_preview }}€</td>\n                <td class=\"pt-4\">{{ meal.state }}</td>\n                <td class=\"pt-4\">{{ moment(meal.created_at).format(\"DD/MM/YYYY\") }}</td>\n                <td class=\"p-0\">\n                  <md-tooltip md-direction=\"top\">View meal details</md-tooltip>\n                  <md-button @click=\"getMealDetails(meal)\"><md-icon>remove_red_eye</md-icon></md-button>\n                </td>\n              </tr>\n              </tbody>\n            </table>\n            <md-button :disabled=\"meals.data.prev_page_url === null\" @click=\"mealsPaginate('last')\">LAST</md-button>\n            <md-button :disabled=\"meals.data.next_page_url === null\" @click=\"mealsPaginate('next')\">NEXT</md-button>\n          </md-card-content>\n        </md-card>\n\n        <!-- MEAL DETAILS -->\n        <div v-if=\"meals.selected.meal !== null\">\n          <md-card>\n            <md-card-header data-background-color=\"green\" id=\"mealDetails\">\n              <h4 class=\"title\">Meal</h4>\n              <h6 class=\"title\">Total: {{ meals.selected.meal.total_price_preview }}€</h6>\n              <h6 class=\"title\">State: {{ meals.selected.meal.state }}</h6>\n              <h6 class=\"title\">Date: {{ moment(meals.selected.meal.created_at).format(\"DD/MM/YYYY\") }}</h6>\n              <h6 class=\"title\">Waiter: {{ meals.selected.meal.waiter.name }}</h6>\n            </md-card-header>\n            <md-card-content>\n              <table class=\"table\">\n                <thead>\n                <tr>\n                  <th>Item</th>\n                  <th>Type</th>\n                  <th>Price</th>\n                  <th>State</th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr v-for=\"item in meals.selected.items\" :key=\"item.id\">\n                  <td class=\"pt-4\">{{ item.item.name }}</td>\n                  <td class=\"pt-4\">{{ item.item.type }}</td>\n                  <td class=\"pt-4\">{{ item.item.price }}€</td>\n                  <td class=\"pt-4\">{{ item.state }}</td>\n                </tr>\n                </tbody>\n              </table>\n            </md-card-content>\n          </md-card>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport MealsAPI from \"../../packages/api/Meals.js\";\nimport ItemsAPI from \"../../packages/api/Items.js\";\nimport OrderAPI from \"../../packages/api/Orders.js\";\nimport InvoiceAPI from \"../../packages/api/Invoice.js\";\nimport InvoiceItemsAPI from \"../../packages/api/InvoiceItems.js\";\nimport TablesAPI from \"../../packages/api/Tables.js\";\nimport UsersAPI from \"../../packages/api/Users.js\";\nimport { required, email } from 'vuelidate/lib/validators'\nimport toastr from 'toastr';\nimport _ from 'lodash';\nimport swal from \"sweetalert\";\nimport Multiselect from 'vue-multiselect'\nimport Datepicker from 'vuejs-datepicker';\nimport moment from 'moment';\n\nexport default {\n  components: { Multiselect, Datepicker },\n  data() {\n    return {\n      meals: {\n        data: [],\n        filters: {\n          state: {\n            // If there are no active option then it will assume all the options\n            active: ['active', 'terminated'],\n            options: ['active', 'terminated', 'paid', 'not paid'],\n          },\n          waiter: {\n            active: {\n              id: null,\n              name: null\n            },\n            options: [],\n            isLoading: false\n          },\n          date:{\n            date: null\n          }\n        },\n        terminated: [],\n        selected: {\n          meal: null,\n          items: []\n        }\n      },\n    }\n  },\n  methods: {\n    getMeals(filters, paginate, waiter, pageNumber, userID, date){\n      MealsAPI.getMeals(filters, paginate, waiter, pageNumber, userID, date).then(meals => {\n        this.meals.data = meals.data;\n      });\n    },\n    searchUsersMeals(searchQuery){\n      if(searchQuery.length < 3){\n        return;\n      }\n\n      var options = [];\n      this.meals.filters.waiter.isLoading = true;\n\n      UsersAPI.getSearchUser(searchQuery).then(r => {\n        this.meals.filters.waiter.isLoading = false;\n        r.data.forEach(e => {\n          options.push({\n            id: e.id,\n            name: e.name\n          });\n        });\n      });\n\n      this.meals.filters.waiter.options = options;\n    },\n    dataFilter(date){\n      let dateF = moment(date).format('YYYY-MM-DD');\n      this.meals.filters.date.date = dateF;\n      return dateF;\n    },\n    getMealDetails(meal){\n      this.meals.selected.meal = meal;\n      MealsAPI.getOrders([], meal.id).then(orders => {\n        this.meals.selected.items = orders.data;\n\n        location.hash = \"#mealDetails\";\n      });\n    },\n    mealsPaginate(direction){\n      if(direction === 'last'){\n        this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active, true, true, this.meals.data.current_page - 1, this.meals.filters.waiter.active.id, this.meals.filters.date.date);\n      }else{\n        this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active, true, true, this.meals.data.current_page + 1, this.meals.filters.waiter.active.id, this.meals.filters.date.date);\n      }\n    },\n  },\n  created(){\n    this.getMeals(this.meals.filters.state.active.length === 0 ? this.meals.filters.state.options : this.meals.filters.state.active,\n      true, true, null, null, this.meals.filters.date.date);\n  }\n};\n</script>\n"],"sourceRoot":"src/pages/Manager"}]}