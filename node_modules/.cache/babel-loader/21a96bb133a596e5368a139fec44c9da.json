{"remainingRequest":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/babel-loader/lib/index.js!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/eslint-loader/index.js??ref--13-0!/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/stores/store.js","dependencies":[{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/stores/store.js","mtime":1546621354136},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport _JSON$stringify from \"/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\n\n/*jshint esversion: 6 */\nimport Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport axios from 'axios';\nVue.use(Vuex);\nvar store = new Vuex.Store({\n  state: {\n    token: localStorage.getItem('access_token') || null,\n    user: JSON.parse(localStorage.getItem('user')) || null\n  },\n  getters: {\n    loggedIn: function loggedIn(state) {\n      return state.token !== null;\n    }\n  },\n  mutations: {\n    retrieveToken: function retrieveToken(state, token) {\n      state.token = token;\n    },\n    destroyTokenAndUser: function destroyTokenAndUser(state) {\n      state.token = null;\n      state.user = null;\n    },\n    setUser: function setUser(state, user) {\n      state.user = user;\n      localStorage.setItem('user', _JSON$stringify(user));\n    },\n    loadTokenAndUserFromSession: function loadTokenAndUserFromSession(state) {\n      state.token = \"\";\n      state.user = null;\n      var token = localStorage.getItem('token');\n      var user = localStorage.getItem('user');\n\n      if (token) {\n        state.token = token;\n        axios.defaults.headers.common.Authorization = \"Bearer \" + token;\n      }\n\n      if (user) {\n        state.user = JSON.parse(user);\n      }\n    }\n  },\n  actions: {\n    destroyTokenAndUser: function destroyTokenAndUser(contex) {\n      if (contex.getters.loggedIn) {\n        return new _Promise(function (resolve, reject) {\n          axios.post(\"/api/logout\").then(function (response) {\n            localStorage.removeItem('access_token');\n            localStorage.removeItem('user');\n            contex.commit('destroyTokenAndUser');\n            resolve(response);\n          }).catch(function (error) {\n            localStorage.removeItem('access_token');\n            localStorage.removeItem('user');\n            contex.commit('destroyTokenAndUser');\n            reject(error);\n          });\n        });\n      }\n    },\n    retrieveToken: function retrieveToken(contex, credentials) {\n      return new _Promise(function (resolve, reject) {\n        axios.post(\"/api/login\", {\n          username: credentials.username,\n          password: credentials.password\n        }).then(function (response) {\n          var token = response.data.access_token;\n          localStorage.setItem('access_token', token);\n          contex.commit('retrieveToken', token);\n          resolve(response);\n        }).catch(function (error) {\n          console.log(error);\n          reject(error);\n        });\n      });\n    }\n  }\n});\nexport default store;",{"version":3,"sources":["/home/alendouro/WebDevelopment/RestaurantManagementVueJS2/src/stores/store.js"],"names":["Vue","Vuex","axios","use","store","Store","state","token","localStorage","getItem","user","JSON","parse","getters","loggedIn","mutations","retrieveToken","destroyTokenAndUser","setUser","setItem","loadTokenAndUserFromSession","defaults","headers","common","Authorization","actions","contex","resolve","reject","post","then","removeItem","commit","response","catch","error","credentials","username","password","data","access_token","console","log"],"mappings":"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","sourcesContent":["/*jshint esversion: 6 */\n\nimport Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport axios from 'axios';\n\nVue.use(Vuex);\n\nconst store = new Vuex.Store({\n  state: {\n    token: localStorage.getItem('access_token') || null,\n    user: JSON.parse(localStorage.getItem('user')) || null,\n  },\n  getters:{\n    loggedIn(state){\n      return state.token !== null;\n    },\n  },\n  mutations: {\n    retrieveToken(state, token){\n      state.token = token;\n    },\n    destroyTokenAndUser(state){\n      state.token = null;\n      state.user = null;\n    },\n    setUser: (state, user) => {\n      state.user = user;\n      localStorage.setItem('user', JSON.stringify(user));\n    },\n    loadTokenAndUserFromSession: state => {\n      state.token = \"\";\n      state.user = null;\n      let token = localStorage.getItem('token');\n      let user = localStorage.getItem('user');\n      if (token) {\n        state.token = token;\n        axios.defaults.headers.common.Authorization = \"Bearer \" + token;\n      }\n      if (user){\n        state.user = JSON.parse(user);\n      }\n    }\n  },\n  actions: {\n    destroyTokenAndUser(contex) {\n      if (contex.getters.loggedIn){\n        return new Promise((resolve, reject) => {\n          axios\n            .post(\"/api/logout\")\n            .then(response => {\n              localStorage.removeItem('access_token');\n              localStorage.removeItem('user');\n              contex.commit('destroyTokenAndUser');\n              resolve(response);\n            })\n            .catch(error => {\n              localStorage.removeItem('access_token');\n              localStorage.removeItem('user');\n              contex.commit('destroyTokenAndUser'); \n              reject(error);\n            });\n        });\n      }\n    },\n    retrieveToken(contex, credentials) {\n      return new Promise((resolve, reject) => {\n        axios\n          .post(\"/api/login\", {\n            username: credentials.username,\n            password: credentials.password\n          })\n          .then(response => {\n            const token = response.data.access_token;\n\n            localStorage.setItem('access_token', token);\n            contex.commit('retrieveToken', token);\n            resolve(response);\n          })\n          .catch(error => {\n            console.log(error);\n            reject(error);\n          });\n      });\n    },\n  }\n});\nexport default store;\n"]}]}